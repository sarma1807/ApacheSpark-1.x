{"paragraphs":[{"text":"%md #### RDD = Resilient Distributed Dataset [ contains ONLY data ]\n#### Schema + RDD = DataFrame","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816959_1993468325","id":"20160406-193656_523156818","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>RDD = Resilient Distributed Dataset [ contains ONLY data ]</h4>\n<h4>Schema + RDD = DataFrame</h4>\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:39 PM","dateFinished":"Apr 7, 2016 1:11:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3060"},{"text":"%sh ls -lh /home/cass/scalaSpark/usa_daily_avg_temps.csv","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816959_1993468325","id":"20160406-193656_837662793","result":{"code":"SUCCESS","type":"TEXT","msg":"-rw-r--r-- 1 cass cassgrp 40M Mar  2 16:01 /home/cass/scalaSpark/usa_daily_avg_temps.csv\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:39 PM","dateFinished":"Apr 7, 2016 1:11:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3061"},{"text":"%sh head -5 /home/cass/scalaSpark/usa_daily_avg_temps.csv","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816959_1993468325","id":"20160406-193656_1539670222","result":{"code":"SUCCESS","type":"TEXT","msg":"state,city,month,day,year,avgtemp\r\nAlabama,Birmingham,1,1,1995,50.7\r\nAlabama,Birmingham,1,1,1996,56.8\r\nAlabama,Birmingham,1,1,1997,60.9\r\nAlabama,Birmingham,1,1,1998,35.6\r\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:39 PM","dateFinished":"Apr 7, 2016 1:11:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3062"},{"text":"%md #### usa_daily_avg_temps.csv file contains nearly 21 years of daily average temperatures for major cities of USA\n#### let us process this file using Apache Spark SQL","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816959_1993468325","id":"20160406-193656_457312","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>usa_daily_avg_temps.csv file contains nearly 21 years of daily average temperatures for major cities of USA</h4>\n<h4>let us process this file using Apache Spark SQL</h4>\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:39 PM","dateFinished":"Apr 7, 2016 1:11:39 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3063"},{"title":"SparkContext","text":"// sc is the SparkContext\nsc","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816959_1993468325","id":"20160406-193656_1789399839","result":{"code":"SUCCESS","type":"TEXT","msg":"res649: org.apache.spark.SparkContext = org.apache.spark.SparkContext@62e96d5f\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:39 PM","dateFinished":"Apr 7, 2016 1:11:40 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3064"},{"title":"sqlContext","text":"sqlContext","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816959_1993468325","id":"20160406-193656_911983091","result":{"code":"SUCCESS","type":"TEXT","msg":"res651: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@245aba87\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:39 PM","dateFinished":"Apr 7, 2016 1:11:40 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3065"},{"title":"Import packages required for spark SQL Support","text":"import org.apache.spark._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816959_1993468325","id":"20160406-193656_1097851910","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:40 PM","dateFinished":"Apr 7, 2016 1:11:46 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3066"},{"title":"Case Class","text":"// schema can be defined using case class\n\ncase class clsTemps(state:String, city:String, month:Int, day:Int, year:Int, avgtemp:Double)","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816960_2077728334","id":"20160406-193656_1989002161","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class clsTemps\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:41 PM","dateFinished":"Apr 7, 2016 1:11:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3067"},{"title":"Read a flat file from fileSystem","text":"val usaTemps = sc.textFile(\"/home/cass/scalaSpark/usa_daily_avg_temps.csv\") // Spark Transformation result is a RDD","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816960_2077728334","id":"20160406-193656_1553405588","result":{"code":"SUCCESS","type":"TEXT","msg":"usaTemps: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[599] at textFile at <console>:134\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:47 PM","dateFinished":"Apr 7, 2016 1:11:48 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3068"},{"title":"apply case class to rDD","text":"// convert each row to lower-case : filter rows belonging to \",boston,\" : map & split based on \",\" : \n// apply previously defined case class : result is a RDD of rows of case class\n\nval bostonTemps = usaTemps.filter(_.toLowerCase.contains(\",boston,\")).map(_.split(\",\"))\n.map(t => clsTemps(t(0), t(1), t(2).toInt, t(3).toInt, t(4).toInt, t(5).toDouble))","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816960_2077728334","id":"20160406-193656_883626156","result":{"code":"SUCCESS","type":"TEXT","msg":"bostonTemps: org.apache.spark.rdd.RDD[clsTemps] = MapPartitionsRDD[602] at map at <console>:142\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:47 PM","dateFinished":"Apr 7, 2016 1:11:49 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3069"},{"title":"Convert RDD to Spark SQL DataFrame","text":"val bostonTempsDF = bostonTemps.toDF // result is a Spark SQL DataFrame","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816960_2077728334","id":"20160406-193656_182095339","result":{"code":"SUCCESS","type":"TEXT","msg":"bostonTempsDF: org.apache.spark.sql.DataFrame = [state: string, city: string, month: int, day: int, year: int, avgtemp: double]\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:48 PM","dateFinished":"Apr 7, 2016 1:11:50 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3070"},{"title":"Register DataFrame as a temporary spark SQL table","text":"bostonTempsDF.registerTempTable(\"BT\")","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816960_2077728334","id":"20160406-193656_307386186","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:49 PM","dateFinished":"Apr 7, 2016 1:11:51 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3071"},{"text":"bostonTempsDF.show(5) // action on DataFrame produces output in tablular format","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816960_2077728334","id":"20160406-193656_1989525538","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------------+------+-----+---+----+-------+\n|        state|  city|month|day|year|avgtemp|\n+-------------+------+-----+---+----+-------+\n|Massachusetts|Boston|    1|  1|1995|   38.5|\n|Massachusetts|Boston|    1|  1|1996|   34.1|\n|Massachusetts|Boston|    1|  1|1997|   10.0|\n|Massachusetts|Boston|    1|  1|1998|   14.2|\n|Massachusetts|Boston|    1|  1|1999|   21.7|\n+-------------+------+-----+---+----+-------+\nonly showing top 5 rows\n\n"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:50 PM","dateFinished":"Apr 7, 2016 1:11:52 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3072"},{"title":"Zeppelin's in-built data Visualization","text":"%sql\n// Spark SQL\nSELECT year, min(avgtemp) min_temp, max(avgtemp) max_temp \nFROM BT \nWHERE avgtemp <> -99 // ignore unknown temperature values\nGROUP BY year \nORDER BY year","dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"graph":{"mode":"lineChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"max_temp","index":2,"aggr":"sum"},{"name":"min_temp","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year","index":0,"aggr":"sum"},"yAxis":{"name":"max_temp","index":2,"aggr":"sum"}},"forceY":false,"lineWithFocus":false},"enabled":true,"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985843033_-1425400534","id":"20160406-193723_411098221","result":{"code":"SUCCESS","type":"TABLE","msg":"year\tmin_temp\tmax_temp\n1995\t7.3\t88.4\n1996\t8.8\t80.4\n1997\t8.9\t83.3\n1998\t14.2\t81.9\n1999\t9.3\t87.9\n2000\t6.7\t81.5\n2001\t17.1\t87.4\n2002\t21.7\t87.5\n2003\t5.1\t84.9\n2004\t0.7\t81.1\n2005\t6.9\t83.6\n2006\t14.5\t90.1\n2007\t8.8\t86.1\n2008\t11.0\t85.1\n2009\t11.7\t83.6\n2010\t13.2\t85.9\n2011\t6.4\t90.7\n2012\t15.2\t88.2\n2013\t10.9\t87.7\n2014\t6.4\t80.9\n2015\t6.5\t83.5\n","comment":"","msgTable":[[{"key":"min_temp","value":"1995"},{"key":"min_temp","value":"7.3"},{"key":"min_temp","value":"88.4"}],[{"key":"max_temp","value":"1996"},{"key":"max_temp","value":"8.8"},{"key":"max_temp","value":"80.4"}],[{"value":"1997"},{"value":"8.9"},{"value":"83.3"}],[{"value":"1998"},{"value":"14.2"},{"value":"81.9"}],[{"value":"1999"},{"value":"9.3"},{"value":"87.9"}],[{"value":"2000"},{"value":"6.7"},{"value":"81.5"}],[{"value":"2001"},{"value":"17.1"},{"value":"87.4"}],[{"value":"2002"},{"value":"21.7"},{"value":"87.5"}],[{"value":"2003"},{"value":"5.1"},{"value":"84.9"}],[{"value":"2004"},{"value":"0.7"},{"value":"81.1"}],[{"value":"2005"},{"value":"6.9"},{"value":"83.6"}],[{"value":"2006"},{"value":"14.5"},{"value":"90.1"}],[{"value":"2007"},{"value":"8.8"},{"value":"86.1"}],[{"value":"2008"},{"value":"11.0"},{"value":"85.1"}],[{"value":"2009"},{"value":"11.7"},{"value":"83.6"}],[{"value":"2010"},{"value":"13.2"},{"value":"85.9"}],[{"value":"2011"},{"value":"6.4"},{"value":"90.7"}],[{"value":"2012"},{"value":"15.2"},{"value":"88.2"}],[{"value":"2013"},{"value":"10.9"},{"value":"87.7"}],[{"value":"2014"},{"value":"6.4"},{"value":"80.9"}],[{"value":"2015"},{"value":"6.5"},{"value":"83.5"}]],"columnNames":[{"name":"year","index":0,"aggr":"sum"},{"name":"min_temp","index":1,"aggr":"sum"},{"name":"max_temp","index":2,"aggr":"sum"}],"rows":[["1995","7.3","88.4"],["1996","8.8","80.4"],["1997","8.9","83.3"],["1998","14.2","81.9"],["1999","9.3","87.9"],["2000","6.7","81.5"],["2001","17.1","87.4"],["2002","21.7","87.5"],["2003","5.1","84.9"],["2004","0.7","81.1"],["2005","6.9","83.6"],["2006","14.5","90.1"],["2007","8.8","86.1"],["2008","11.0","85.1"],["2009","11.7","83.6"],["2010","13.2","85.9"],["2011","6.4","90.7"],["2012","15.2","88.2"],["2013","10.9","87.7"],["2014","6.4","80.9"],["2015","6.5","83.5"]]},"dateCreated":"Apr 6, 2016 7:37:23 PM","dateStarted":"Apr 7, 2016 1:11:51 PM","dateFinished":"Apr 7, 2016 1:11:54 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3073"},{"dateUpdated":"Apr 7, 2016 1:11:39 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985816961_2077343585","id":"20160406-193656_471353594","result":{"code":"SUCCESS","type":"TEXT"},"dateCreated":"Apr 6, 2016 7:36:56 PM","dateStarted":"Apr 7, 2016 1:11:52 PM","dateFinished":"Apr 7, 2016 1:11:54 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3074"}],"name":"003_SparkSQL_Fundamentals_Part-02","id":"2BGRVN5GV","angularObjects":{"2BGTPTPZV":[],"2BGNTTNK4":[],"2BEWP714S":[],"2BEEUT3T4":[],"2BGWK6VWJ":[],"2BEUSDEEK":[],"2BGE81CGN":[],"2BDQ41J61":[],"2BEHW8R1A":[],"2BE4VNXST":[],"2BGD1NFRR":[],"2BEPBTFNR":[],"2BDTEUUHC":[],"2BFSGRMJT":[]},"config":{"looknfeel":"default"},"info":{}}