{"paragraphs":[{"title":"Import packages required for spark SQL Support","text":"import org.apache.spark._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._","dateUpdated":"Apr 8, 2016 11:35:54 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460081565387_-250769080","id":"20160407-221245_1838880179","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._\n"},"dateCreated":"Apr 7, 2016 10:12:45 PM","dateStarted":"Apr 8, 2016 11:35:55 AM","dateFinished":"Apr 8, 2016 11:35:57 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1650"},{"title":"Case Class","text":"// schema can be defined using case class\n\ncase class clsMovs(year:Int, runtime:Int, title:String, genre:String, \nleadActor:String, leadActress:String, director:String, popularityRating:Int, gotAwards:String, Image:String)","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460081606949_-507503866","id":"20160407-221326_1457610523","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class clsMovs\n"},"dateCreated":"Apr 7, 2016 10:13:26 PM","dateStarted":"Apr 8, 2016 11:35:55 AM","dateFinished":"Apr 8, 2016 11:35:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1651"},{"title":"Read a flat file from fileSystem","text":"val moviesFile = sc.textFile(\"/home/cass/scalaSpark/movies_info.csv\") // Spark Transformation result is a RDD","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460081459986_-2003974584","id":"20160407-221059_443204757","result":{"code":"SUCCESS","type":"TEXT","msg":"moviesFile: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[77] at textFile at <console>:74\n"},"dateCreated":"Apr 7, 2016 10:10:59 PM","dateStarted":"Apr 8, 2016 11:35:58 AM","dateFinished":"Apr 8, 2016 11:35:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1652"},{"text":"// apply filter transformation to extract header row/column_names row\nval moviesFileHeader = moviesFile.filter(_.contains(\"year;runtime;title;\")) // Spark Transformation : Filter : result is a RDD","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460127177621_464114","id":"20160408-105257_171996486","result":{"code":"SUCCESS","type":"TEXT","msg":"moviesFileHeader: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[78] at filter at <console>:77\n"},"dateCreated":"Apr 8, 2016 10:52:57 AM","dateStarted":"Apr 8, 2016 11:35:58 AM","dateFinished":"Apr 8, 2016 11:35:58 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1653"},{"text":"// remove header from the main file RDD\nval moviesFile_NoHeader = moviesFile.subtract(moviesFileHeader) \n// Spark Transformation : subtract RDD from another RDD : result is a RDD","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460129001120_-575300318","id":"20160408-112321_106556820","result":{"code":"SUCCESS","type":"TEXT","msg":"moviesFile_NoHeader: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[82] at subtract at <console>:79\n"},"dateCreated":"Apr 8, 2016 11:23:21 AM","dateStarted":"Apr 8, 2016 11:35:58 AM","dateFinished":"Apr 8, 2016 11:35:59 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1654"},{"title":"apply case class to rDD","text":"// map & split based on \";\" : \n// apply previously defined case class : result is a RDD of rows of case class\n\nval moviesFileWithClass = moviesFile_NoHeader.map(_.split(\";\"))\n.map(t => clsMovs(\n    if (t(0).length > 0) t(0).toInt else 0, \n    if (t(1).length > 0) t(1).toInt else 0,\n    t(2), t(3), t(4), t(5), t(6), \n    if (t(7).length > 0) t(7).toInt else 0,\n    t(8), t(9)\n))","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460081937061_1698922163","id":"20160407-221857_1844722565","result":{"code":"SUCCESS","type":"TEXT","msg":"moviesFileWithClass: org.apache.spark.rdd.RDD[clsMovs] = MapPartitionsRDD[84] at map at <console>:86\n"},"dateCreated":"Apr 7, 2016 10:18:57 PM","dateStarted":"Apr 8, 2016 11:35:59 AM","dateFinished":"Apr 8, 2016 11:35:59 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1655"},{"title":"Convert RDD to Spark SQL DataFrame","text":"val moviesFileDF = moviesFileWithClass.toDF // result is a Spark SQL DataFrame","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460129099631_-832358556","id":"20160408-112459_260404588","result":{"code":"SUCCESS","type":"TEXT","msg":"moviesFileDF: org.apache.spark.sql.DataFrame = [year: int, runtime: int, title: string, genre: string, leadActor: string, leadActress: string, director: string, popularityRating: int, gotAwards: string, Image: string]\n"},"dateCreated":"Apr 8, 2016 11:24:59 AM","dateStarted":"Apr 8, 2016 11:35:59 AM","dateFinished":"Apr 8, 2016 11:36:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1656"},{"title":"Register DataFrame as a temporary spark SQL table","text":"moviesFileDF.registerTempTable(\"movs\")","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460129184267_1699044020","id":"20160408-112624_154684261","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 8, 2016 11:26:24 AM","dateStarted":"Apr 8, 2016 11:36:00 AM","dateFinished":"Apr 8, 2016 11:36:00 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1657"},{"text":"moviesFileDF.show(5)","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460081459989_-2006667826","id":"20160407-221059_1189393887","result":{"code":"SUCCESS","type":"TEXT","msg":"+----+-------+--------------------+-------+-------------------+-------------------+-------------------+----------------+---------+-------------------+\n|year|runtime|               title|  genre|          leadActor|        leadActress|           director|popularityRating|gotAwards|              Image|\n+----+-------+--------------------+-------+-------------------+-------------------+-------------------+----------------+---------+-------------------+\n|1986|    130|El Guerrero Solit...|  Drama|    Eastwood, Clint|      Mason, Marsha|    Eastwood, Clint|              77|       No|  clintEastwood.png|\n|1943|     99|           Destroyer| Action|Robinson, Edward G.|Chapman, Marguerite| Seiter, William A.|              87|       No|   NicholasCage.png|\n|1968|    121|        Hellfighters| Action|        Wayne, John|    Ross, Katharine|McLaglen, Andrew V.|              22|       No|      johnWayne.png|\n|1936|     84|        Secret Agent|Mystery|       Lorre, Peter| Carroll, Madeleine|  Hitchcock, Alfred|              50|       No|alfredHitchcock.png|\n|1989|    127|Fat Man & Little Boy|  Drama|       Newman, Paul|        Dern, Laura|      Joffe, Roland|              86|       No|     paulNewman.png|\n+----+-------+--------------------+-------+-------------------+-------------------+-------------------+----------------+---------+-------------------+\nonly showing top 5 rows\n\n"},"dateCreated":"Apr 7, 2016 10:10:59 PM","dateStarted":"Apr 8, 2016 11:36:00 AM","dateFinished":"Apr 8, 2016 11:36:01 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1658"},{"text":"%sql\nSELECT year, count(*) NoOfMovies\nFROM movs\nGROUP BY year\nHAVING count(*) > 40\nORDER BY 2 DESC\n","dateUpdated":"Apr 8, 2016 11:35:55 AM","config":{"colWidth":12,"graph":{"mode":"pieChart","height":300,"optionOpen":false,"keys":[{"name":"year","index":0,"aggr":"sum"}],"values":[{"name":"NoOfMovies","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"year","index":0,"aggr":"sum"},"yAxis":{"name":"NoOfMovies","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460129323663_1924289048","id":"20160408-112843_1454223972","result":{"code":"SUCCESS","type":"TABLE","msg":"year\tNoOfMovies\n1985\t42\n1986\t95\n1987\t102\n1988\t96\n1989\t101\n1990\t105\n1991\t129\n1992\t88\n","comment":"","msgTable":[[{"key":"NoOfMovies","value":"1985"},{"key":"NoOfMovies","value":"42"}],[{"value":"1986"},{"value":"95"}],[{"value":"1987"},{"value":"102"}],[{"value":"1988"},{"value":"96"}],[{"value":"1989"},{"value":"101"}],[{"value":"1990"},{"value":"105"}],[{"value":"1991"},{"value":"129"}],[{"value":"1992"},{"value":"88"}]],"columnNames":[{"name":"year","index":0,"aggr":"sum"},{"name":"NoOfMovies","index":1,"aggr":"sum"}],"rows":[["1985","42"],["1986","95"],["1987","102"],["1988","96"],["1989","101"],["1990","105"],["1991","129"],["1992","88"]]},"dateCreated":"Apr 8, 2016 11:28:43 AM","dateStarted":"Apr 8, 2016 11:36:01 AM","dateFinished":"Apr 8, 2016 11:36:02 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1659"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1460129435360_820629988","id":"20160408-113035_1379649875","dateCreated":"Apr 8, 2016 11:30:35 AM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1660","dateUpdated":"Apr 8, 2016 11:35:55 AM","dateFinished":"Apr 8, 2016 11:36:02 AM","dateStarted":"Apr 8, 2016 11:36:01 AM","result":{"code":"SUCCESS","type":"TEXT"}}],"name":"003_SparkSQL_Fundamentals_Part-03","id":"2BGW3TZXQ","angularObjects":{"2BGTPTPZV":[],"2BGNTTNK4":[],"2BEWP714S":[],"2BEEUT3T4":[],"2BGWK6VWJ":[],"2BEUSDEEK":[],"2BGE81CGN":[],"2BDQ41J61":[],"2BEHW8R1A":[],"2BE4VNXST":[],"2BGD1NFRR":[],"2BEPBTFNR":[],"2BDTEUUHC":[],"2BFSGRMJT":[]},"config":{"looknfeel":"default"},"info":{}}