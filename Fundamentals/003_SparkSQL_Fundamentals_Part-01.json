{"paragraphs":[{"text":"%md #### RDD = Resilient Distributed Dataset [ contains ONLY data ]\n#### Schema + RDD = DataFrame","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459984188318_1744618462","id":"20160406-190948_417486","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>RDD = Resilient Distributed Dataset [ contains ONLY data ]</h4>\n<h4>Schema + RDD = DataFrame</h4>\n"},"dateCreated":"Apr 6, 2016 7:09:48 PM","dateStarted":"Apr 7, 2016 1:11:03 PM","dateFinished":"Apr 7, 2016 1:11:03 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2717"},{"text":"%sh ls -lh /home/cass/scalaSpark/usa_daily_avg_temps.csv","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459983830392_308029010","id":"20160406-190350_1216157030","result":{"code":"SUCCESS","type":"TEXT","msg":"-rw-r--r-- 1 cass cassgrp 40M Mar  2 16:01 /home/cass/scalaSpark/usa_daily_avg_temps.csv\n"},"dateCreated":"Apr 6, 2016 7:03:50 PM","dateStarted":"Apr 7, 2016 1:11:03 PM","dateFinished":"Apr 7, 2016 1:11:03 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2718"},{"text":"%sh head -5 /home/cass/scalaSpark/usa_daily_avg_temps.csv","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459983830392_308029010","id":"20160406-190350_1892420781","result":{"code":"SUCCESS","type":"TEXT","msg":"state,city,month,day,year,avgtemp\r\nAlabama,Birmingham,1,1,1995,50.7\r\nAlabama,Birmingham,1,1,1996,56.8\r\nAlabama,Birmingham,1,1,1997,60.9\r\nAlabama,Birmingham,1,1,1998,35.6\r\n"},"dateCreated":"Apr 6, 2016 7:03:50 PM","dateStarted":"Apr 7, 2016 1:11:03 PM","dateFinished":"Apr 7, 2016 1:11:03 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2719"},{"text":"%md #### usa_daily_avg_temps.csv file contains nearly 21 years of daily average temperatures for major cities of USA\n#### let us process this file using Apache Spark SQL","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459983830393_307644261","id":"20160406-190350_2038390558","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>usa_daily_avg_temps.csv file contains nearly 21 years of daily average temperatures for major cities of USA</h4>\n<h4>let us process this file using Apache Spark SQL</h4>\n"},"dateCreated":"Apr 6, 2016 7:03:50 PM","dateStarted":"Apr 7, 2016 1:11:03 PM","dateFinished":"Apr 7, 2016 1:11:03 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2720"},{"title":"SparkContext","text":"// sc is SparkContext\nsc","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459984988361_-329456710","id":"20160406-192308_993543065","result":{"code":"SUCCESS","type":"TEXT","msg":"res622: org.apache.spark.SparkContext = org.apache.spark.SparkContext@62e96d5f\n"},"dateCreated":"Apr 6, 2016 7:23:08 PM","dateStarted":"Apr 7, 2016 1:11:03 PM","dateFinished":"Apr 7, 2016 1:11:04 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2721"},{"title":"sqlContext","text":"sqlContext","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985034855_-1101755022","id":"20160406-192354_1257627732","result":{"code":"SUCCESS","type":"TEXT","msg":"res624: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@245aba87\n"},"dateCreated":"Apr 6, 2016 7:23:54 PM","dateStarted":"Apr 7, 2016 1:11:03 PM","dateFinished":"Apr 7, 2016 1:11:04 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2722"},{"title":"Import packages required for spark SQL Support","text":"import org.apache.spark._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459983830393_307644261","id":"20160406-190350_676522537","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport sqlContext.implicits._\n"},"dateCreated":"Apr 6, 2016 7:03:50 PM","dateStarted":"Apr 7, 2016 1:11:04 PM","dateFinished":"Apr 7, 2016 1:11:09 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2723"},{"title":"Case Class","text":"// schema can be defined using case class\n\ncase class clsTemps(state:String, city:String, month:Int, day:Int, year:Int, avgtemp:Double)","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459983830394_308798508","id":"20160406-190350_1300344265","result":{"code":"SUCCESS","type":"TEXT","msg":"defined class clsTemps\n"},"dateCreated":"Apr 6, 2016 7:03:50 PM","dateStarted":"Apr 7, 2016 1:11:05 PM","dateFinished":"Apr 7, 2016 1:11:09 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2724"},{"title":"Read a flat file from fileSystem","text":"val usaTemps = sc.textFile(\"/home/cass/scalaSpark/usa_daily_avg_temps.csv\") // Spark Transformation result is a RDD","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459983830393_307644261","id":"20160406-190350_136583278","result":{"code":"SUCCESS","type":"TEXT","msg":"usaTemps: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[560] at textFile at <console>:119\n"},"dateCreated":"Apr 6, 2016 7:03:50 PM","dateStarted":"Apr 7, 2016 1:11:09 PM","dateFinished":"Apr 7, 2016 1:11:10 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2725"},{"title":"apply case class to rDD","text":"// convert each row to lower-case : filter rows belonging to \",boston,\" : map & split based on \",\" : \n// apply previously defined case class : result is a RDD of rows of case class\n\nval bostonTemps = usaTemps.filter(_.toLowerCase.contains(\",boston,\")).map(_.split(\",\"))\n.map(t => clsTemps(t(0), t(1), t(2).toInt, t(3).toInt, t(4).toInt, t(5).toDouble))","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459984156338_966994962","id":"20160406-190916_272222782","result":{"code":"SUCCESS","type":"TEXT","msg":"bostonTemps: org.apache.spark.rdd.RDD[clsTemps] = MapPartitionsRDD[563] at map at <console>:127\n"},"dateCreated":"Apr 6, 2016 7:09:16 PM","dateStarted":"Apr 7, 2016 1:11:10 PM","dateFinished":"Apr 7, 2016 1:11:11 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2726"},{"title":"Convert RDD to Spark SQL DataFrame","text":"val bostonTempsDF = bostonTemps.toDF // result is a Spark SQL DataFrame","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459984527561_1901487099","id":"20160406-191527_1136001589","result":{"code":"SUCCESS","type":"TEXT","msg":"bostonTempsDF: org.apache.spark.sql.DataFrame = [state: string, city: string, month: int, day: int, year: int, avgtemp: double]\n"},"dateCreated":"Apr 6, 2016 7:15:27 PM","dateStarted":"Apr 7, 2016 1:11:11 PM","dateFinished":"Apr 7, 2016 1:11:12 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2727"},{"title":"Register DataFrame as a temporary spark SQL table","text":"bostonTempsDF.registerTempTable(\"BT\")","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459984741259_1484325702","id":"20160406-191901_1602022309","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"Apr 6, 2016 7:19:01 PM","dateStarted":"Apr 7, 2016 1:11:11 PM","dateFinished":"Apr 7, 2016 1:11:13 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2728"},{"text":"bostonTempsDF.show(5) // action on DataFrame produces output in tablular format","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985741206_706944624","id":"20160406-193541_1512508773","result":{"code":"SUCCESS","type":"TEXT","msg":"+-------------+------+-----+---+----+-------+\n|        state|  city|month|day|year|avgtemp|\n+-------------+------+-----+---+----+-------+\n|Massachusetts|Boston|    1|  1|1995|   38.5|\n|Massachusetts|Boston|    1|  1|1996|   34.1|\n|Massachusetts|Boston|    1|  1|1997|   10.0|\n|Massachusetts|Boston|    1|  1|1998|   14.2|\n|Massachusetts|Boston|    1|  1|1999|   21.7|\n+-------------+------+-----+---+----+-------+\nonly showing top 5 rows\n\n"},"dateCreated":"Apr 6, 2016 7:35:41 PM","dateStarted":"Apr 7, 2016 1:11:12 PM","dateFinished":"Apr 7, 2016 1:11:14 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2729"},{"title":"Spark SQL on dataFrame","text":"sqlContext.sql(\"SELECT avgtemp, state, city, year, month, day FROM BT\").take(5).foreach(println)","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459984914634_-916506911","id":"20160406-192154_1770694619","result":{"code":"SUCCESS","type":"TEXT","msg":"[38.5,Massachusetts,Boston,1995,1,1]\n[34.1,Massachusetts,Boston,1996,1,1]\n[10.0,Massachusetts,Boston,1997,1,1]\n[14.2,Massachusetts,Boston,1998,1,1]\n[21.7,Massachusetts,Boston,1999,1,1]\n"},"dateCreated":"Apr 6, 2016 7:21:54 PM","dateStarted":"Apr 7, 2016 1:11:13 PM","dateFinished":"Apr 7, 2016 1:11:15 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2730"},{"text":"sqlContext.sql(\"SELECT year, min(avgtemp), max(avgtemp) FROM BT GROUP BY year ORDER BY year DESC\")\n.collect.foreach(println)\n\n// unknown values are represented as -99.0 in the dataset","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459984974825_347701354","id":"20160406-192254_902344154","result":{"code":"SUCCESS","type":"TEXT","msg":"[2015,6.5,83.5]\n[2014,6.4,80.9]\n[2013,10.9,87.7]\n[2012,15.2,88.2]\n[2011,6.4,90.7]\n[2010,13.2,85.9]\n[2009,-99.0,83.6]\n[2008,-99.0,85.1]\n[2007,-99.0,86.1]\n[2006,14.5,90.1]\n[2005,6.9,83.6]\n[2004,0.7,81.1]\n[2003,-99.0,84.9]\n[2002,-99.0,87.5]\n[2001,17.1,87.4]\n[2000,6.7,81.5]\n[1999,-99.0,87.9]\n[1998,-99.0,81.9]\n[1997,8.9,83.3]\n[1996,-99.0,80.4]\n[1995,7.3,88.4]\n"},"dateCreated":"Apr 6, 2016 7:22:54 PM","dateStarted":"Apr 7, 2016 1:11:15 PM","dateFinished":"Apr 7, 2016 1:11:21 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2731"},{"text":"sqlContext.sql(\"SELECT year, min(avgtemp), max(avgtemp) FROM BT WHERE year BETWEEN 2010 AND 2014 GROUP BY year ORDER BY year\")\n.collect.foreach(println)","dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985419365_-794606095","id":"20160406-193019_966003958","result":{"code":"SUCCESS","type":"TEXT","msg":"[2010,13.2,85.9]\n[2011,6.4,90.7]\n[2012,15.2,88.2]\n[2013,10.9,87.7]\n[2014,6.4,80.9]\n"},"dateCreated":"Apr 6, 2016 7:30:19 PM","dateStarted":"Apr 7, 2016 1:11:16 PM","dateFinished":"Apr 7, 2016 1:11:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2732"},{"dateUpdated":"Apr 7, 2016 1:11:03 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459985650378_-2101291625","id":"20160406-193410_532311757","result":{"code":"SUCCESS","type":"TEXT"},"dateCreated":"Apr 6, 2016 7:34:10 PM","dateStarted":"Apr 7, 2016 1:11:22 PM","dateFinished":"Apr 7, 2016 1:11:25 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2733"}],"name":"003_SparkSQL_Fundamentals_Part-01","id":"2BF4BSRRM","angularObjects":{"2BGTPTPZV":[],"2BGNTTNK4":[],"2BEWP714S":[],"2BEEUT3T4":[],"2BGWK6VWJ":[],"2BEUSDEEK":[],"2BGE81CGN":[],"2BDQ41J61":[],"2BEHW8R1A":[],"2BE4VNXST":[],"2BGD1NFRR":[],"2BEPBTFNR":[],"2BDTEUUHC":[],"2BFSGRMJT":[]},"config":{"looknfeel":"default"},"info":{}}