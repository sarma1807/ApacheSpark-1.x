{"paragraphs":[{"text":"%sh ls -lh /home/cass/scalaSpark/usa_daily_avg_temps.csv","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459980626663_1861081363","id":"20160406-181026_162205806","result":{"code":"SUCCESS","type":"TEXT","msg":"-rw-r--r-- 1 cass cassgrp 40M Mar  2 16:01 /home/cass/scalaSpark/usa_daily_avg_temps.csv\n"},"dateCreated":"Apr 6, 2016 6:10:26 PM","dateStarted":"Apr 7, 2016 1:10:43 PM","dateFinished":"Apr 7, 2016 1:10:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2504"},{"text":"%sh head -5 /home/cass/scalaSpark/usa_daily_avg_temps.csv","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"editorMode":"ace/mode/sh","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459980626663_1861081363","id":"20160406-181026_659693112","result":{"code":"SUCCESS","type":"TEXT","msg":"state,city,month,day,year,avgtemp\r\nAlabama,Birmingham,1,1,1995,50.7\r\nAlabama,Birmingham,1,1,1996,56.8\r\nAlabama,Birmingham,1,1,1997,60.9\r\nAlabama,Birmingham,1,1,1998,35.6\r\n"},"dateCreated":"Apr 6, 2016 6:10:26 PM","dateStarted":"Apr 7, 2016 1:10:43 PM","dateFinished":"Apr 7, 2016 1:10:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2505"},{"text":"%md #### usa_daily_avg_temps.csv file contains nearly 21 years of daily average temperatures for major cities of USA\n#### let us process this file using Apache Spark","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459980626664_1859157619","id":"20160406-181026_907654397","result":{"code":"SUCCESS","type":"HTML","msg":"<h4>usa_daily_avg_temps.csv file contains nearly 21 years of daily average temperatures for major cities of USA</h4>\n<h4>let us process this file using Apache Spark</h4>\n"},"dateCreated":"Apr 6, 2016 6:10:26 PM","dateStarted":"Apr 7, 2016 1:10:43 PM","dateFinished":"Apr 7, 2016 1:10:43 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2506"},{"title":"Read a flat file from fileSystem","text":"val usaTemps = sc.textFile(\"/home/cass/scalaSpark/usa_daily_avg_temps.csv\") // Spark Transformation result is a RDD","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","title":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459980626664_1859157619","id":"20160406-181026_333282293","result":{"code":"SUCCESS","type":"TEXT","msg":"usaTemps: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[542] at textFile at <console>:104\n"},"dateCreated":"Apr 6, 2016 6:10:26 PM","dateStarted":"Apr 7, 2016 1:10:43 PM","dateFinished":"Apr 7, 2016 1:10:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2507"},{"title":"This file contains 1,174,606 entries","text":"usaTemps.count","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459980626667_1859542368","id":"20160406-181026_2084185647","result":{"code":"SUCCESS","type":"TEXT","msg":"res602: Long = 1174606\n"},"dateCreated":"Apr 6, 2016 6:10:26 PM","dateStarted":"Apr 7, 2016 1:10:43 PM","dateFinished":"Apr 7, 2016 1:10:44 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2508"},{"text":"usaTemps.take(5).foreach(println) // Spark Action","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459981195015_-1498733211","id":"20160406-181955_1724973058","result":{"code":"SUCCESS","type":"TEXT","msg":"state,city,month,day,year,avgtemp\nAlabama,Birmingham,1,1,1995,50.7\nAlabama,Birmingham,1,1,1996,56.8\nAlabama,Birmingham,1,1,1997,60.9\nAlabama,Birmingham,1,1,1998,35.6\n"},"dateCreated":"Apr 6, 2016 6:19:55 PM","dateStarted":"Apr 7, 2016 1:10:44 PM","dateFinished":"Apr 7, 2016 1:10:45 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2509"},{"title":"Filter \"boston\" data","text":"// convert each row to lower-case : filter rows belonging to \",boston,\" : map & split based on \",\" : get 2 rows\n\nusaTemps.filter(_.toLowerCase.contains(\",boston,\")).map(_.split(\",\")).take(2)","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459981297553_2142130306","id":"20160406-182137_910425256","result":{"code":"SUCCESS","type":"TEXT","msg":"res608: Array[Array[String]] = Array(Array(Massachusetts, Boston, 1, 1, 1995, 38.5), Array(Massachusetts, Boston, 1, 1, 1996, 34.1))\n"},"dateCreated":"Apr 6, 2016 6:21:37 PM","dateStarted":"Apr 7, 2016 1:10:45 PM","dateFinished":"Apr 7, 2016 1:10:46 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2510"},{"title":"file contains Boston data for years 1995 to 2015","text":"// convert each row to lower-case : filter rows belonging to \",boston,\" : map & split based on \",\" : \n// get year from 5th column : convert to Int : get distinct values : collect results\n \nusaTemps.filter(_.toLowerCase.contains(\",boston,\")).map(_.split(\",\")).map(_(4).toInt).distinct.collect","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459982390161_-160631256","id":"20160406-183950_1325209152","result":{"code":"SUCCESS","type":"TEXT","msg":"res613: Array[Int] = Array(1998, 2000, 2010, 2002, 2014, 2008, 2006, 2012, 1996, 2004, 2001, 2003, 2005, 2015, 2013, 1995, 1999, 2009, 2011, 1997, 2007)\n"},"dateCreated":"Apr 6, 2016 6:39:50 PM","dateStarted":"Apr 7, 2016 1:10:46 PM","dateFinished":"Apr 7, 2016 1:10:47 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2511"},{"title":"Range filter","text":"// convert each row to lower-case : filter rows belonging to \",boston,\" : map & split based on \",\" : \n// get year from 5th column : convert to Int : filter for years between 2010 & 2013 : convert to Int\n// get distinct values : collect results\n\nusaTemps.filter(_.toLowerCase.contains(\",boston,\")).map(_.split(\",\")).filter(_(4).toInt >= 2010)\n.filter(_(4).toInt < 2014).map(_(4).toInt).distinct.collect","dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459982845887_-870647339","id":"20160406-184725_1140604993","result":{"code":"SUCCESS","type":"TEXT","msg":"res619: Array[Int] = Array(2010, 2012, 2013, 2011)\n"},"dateCreated":"Apr 6, 2016 6:47:25 PM","dateStarted":"Apr 7, 2016 1:10:47 PM","dateFinished":"Apr 7, 2016 1:10:48 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2512"},{"dateUpdated":"Apr 7, 2016 1:10:43 PM","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1459983497148_-1259541465","id":"20160406-185817_1041019626","result":{"code":"SUCCESS","type":"TEXT"},"dateCreated":"Apr 6, 2016 6:58:17 PM","dateStarted":"Apr 7, 2016 1:10:48 PM","dateFinished":"Apr 7, 2016 1:10:48 PM","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2513"}],"name":"002_Spark_Fundamentals_Part-02","id":"2BH75SXWR","angularObjects":{"2BGTPTPZV":[],"2BGNTTNK4":[],"2BEWP714S":[],"2BEEUT3T4":[],"2BGWK6VWJ":[],"2BEUSDEEK":[],"2BGE81CGN":[],"2BDQ41J61":[],"2BEHW8R1A":[],"2BE4VNXST":[],"2BGD1NFRR":[],"2BEPBTFNR":[],"2BDTEUUHC":[],"2BFSGRMJT":[]},"config":{"looknfeel":"default"},"info":{}}